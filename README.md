# Monte_Carlo_Pi

## 中間平方法で偏りが生じる
- 一度sが100未満になると，その後ずっと0<s<100になる．
- 0 <= s < 100 -> 0 <= (s^2 / 100) % 100000 < 100
- x^2 + y^2 << 1になる

## xorshift32
```c
#include <stdint.h>

static uint32_t rng_state = 2463534242u;  // 0以外なら何でも良い

uint32_t xorshift32(void) {
  uint32_t x = rng_state;
  x ^= x << 13;
  x ^= x >> 17;
  x ^= x << 5;
  rng_state = x;
  return x;
}
```
## x % M が偏るのは何故か？
- 乱数空間[0, 2^32)は有限で一様な集合
- % M で[0, M)に写像する->確かにM未満になる
- 2^32がMの倍数でなければ出力される値が偏る．
  - 各値に対応する元の個数が一致しない
  - 先頭側の値が1回多く現れる
  - 結局のところ，出力の周期が途中で途切れてしまうということ．

## (x * M) >> 32
- xは[0, 2^32)を一様に動く
- x * Mは[0, M * 2^32)を一様に動く
- >>32は2^32で割る動作
- 結果的に[0, 2^32)をM等分出来ていて，偏りが小さい．
